<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">

  <link rel="stylesheet" href="/css/main.css">
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700|Raleway:300,300i,700,700i" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/devicons/devicon@v2.15.1/devicon.min.css">

  <script defer src="https://use.fontawesome.com/releases/v5.8.1/js/all.js" integrity="sha384-g5uSoOSBd7KkhAMlnQILrecXvzst9TdC09/VM+pjDTCM+1il8RHz5fKANTFFb+gQ" crossorigin="anonymous"></script>
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded",function(){
      let node = document.querySelector('.preload-transitions');
      node.classList.remove('preload-transitions');
    });
  </script>

  <link rel="alternate" type="application/rss+xml" title="Development Simplified" href="/feed.xml">

  <!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Add joy to your test suite with Cardi B | Development Simplified</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Add joy to your test suite with Cardi B" />
<meta name="author" content="Josh Frankel (@joshmfrankel)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="We’ve been in the pandemic now for nearly a full year. That’s enough time to make everyone feel a bit down and exhausted. Humor is a great way of coping with pandemic fatigue or you know just generally putting you in a good mood. What better way to encourage yourself than having Cardi B join you for testing your code." />
<meta property="og:description" content="We’ve been in the pandemic now for nearly a full year. That’s enough time to make everyone feel a bit down and exhausted. Humor is a great way of coping with pandemic fatigue or you know just generally putting you in a good mood. What better way to encourage yourself than having Cardi B join you for testing your code." />
<link rel="canonical" href="http://joshfrankel.me/blog/add-joy-to-your-test-suite-with-cardi-b/" />
<meta property="og:url" content="http://joshfrankel.me/blog/add-joy-to-your-test-suite-with-cardi-b/" />
<meta property="og:site_name" content="Development Simplified" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-02-12T15:58:00+00:00" />
<script type="application/ld+json">
{"datePublished":"2021-02-12T15:58:00+00:00","dateModified":"2021-02-12T15:58:00+00:00","headline":"Add joy to your test suite with Cardi B","mainEntityOfPage":{"@type":"WebPage","@id":"http://joshfrankel.me/blog/add-joy-to-your-test-suite-with-cardi-b/"},"url":"http://joshfrankel.me/blog/add-joy-to-your-test-suite-with-cardi-b/","author":{"@type":"Person","name":"Josh Frankel (@joshmfrankel)"},"@type":"BlogPosting","description":"We’ve been in the pandemic now for nearly a full year. That’s enough time to make everyone feel a bit down and exhausted. Humor is a great way of coping with pandemic fatigue or you know just generally putting you in a good mood. What better way to encourage yourself than having Cardi B join you for testing your code.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="theme-color" content="#61b8d0"/>
</head>

  <body class="preload-transitions">
    <header class="Container Container-flex Container--smallMargin Header">

  <a href="/" class="Logo-container">
    <div class="Logo-avatarContainer">
      <img src="/img/layout/josh-frankel-author-100x100.jpg" class="Logo Logo-avatar" alt="Josh Frankel (Author)" />
      <img src="/img/layout/josh-frankel-author-hover-100x100.jpg" class="Logo Logo-avatarHover" alt="Josh Frankel (Author)" />
    </div>
    <div class="Logo Logo-logo">
      <span class="Logo Logo-first-name">Development</span>
      <span class="Logo Logo-last-name">Simplified</span>
    </div>
  </a>

  <nav class="flex-right">
    
      
      <a href="/blog" >Blog</a>
    
      
      <a href="/blog/categories" >Categories</a>
    
      
      <a href="/blog/tags" >Tags</a>
    
      
      <a href="/blog/archives" >Archives</a>
    
      
      <a href="/" >About</a>
    
  </nav>
</header>


    <div class="Banner">
  <div class="Container Container-flex Container--wrap">
    <h1 class="Banner-heading">Add joy to your test suite with Cardi B</h1>

    
      <p class="Banner-information">
        <time>February 12, 2021</time>
      </p>
    
  </div>
</div>


    <div class="Content Container Container-flex">
      <article class="Post">
  





  <p>We’ve been in the pandemic now for nearly a full year. That’s enough time to make everyone feel a bit down and exhausted. Humor is a great way of coping with pandemic fatigue or you know just generally putting you in a good mood. What better way to encourage yourself than having Cardi B join you for testing your code.
<!--excerpt--></p>

<p>This started as a joke in a Slack thread and quickly became a fun little hack I put together. Specifically what I wanted to happen was:</p>

<ul>
  <li>Play a positive sound effect when the test suite passes</li>
  <li>Play a bummer sound effect when the test suite fails</li>
</ul>

<p><img src="/img/2021/eowwww.gif" alt="Cardi B eowwwww" /></p>

<h2 id="finding-a-sound-effect">Finding a sound effect</h2>
<p>First off, you’ll have to download some sound effects. You can find these online by searching YouTube or other soundboard sites and then downloading the files. Once found, save them somewhere you’ll remember.</p>

<h2 id="playing-sound-effects-in-ruby">Playing sound effects in Ruby</h2>

<p>How do you play a sound effect in Ruby? Well, Ruby doesn’t have any knowledge of audio but by using <code class="language-plaintext highlighter-rouge">system(...)</code> it can shell out to your operating system’s primary audio player. For OSX this meant using <code class="language-plaintext highlighter-rouge">afplay [audio-file]</code>. There’s a downside here though. Using <code class="language-plaintext highlighter-rouge">system</code> makes the ruby program wait until the system call is finished. So if you had say a 30 second sound effect, you’d have to wait the spec runtime plus 30 seconds before the script would finish running.</p>

<p>We can do better here. Much better.</p>

<p>Using <code class="language-plaintext highlighter-rouge">fork</code> we can tell Ruby to fork a process in the background to run our shell command. This combined with
<code class="language-plaintext highlighter-rouge">exec</code> allows us to run our sound effect in parallel of the script meaning that the sound effect will play as the script runs. No more waiting! This is what it looks like <code class="language-plaintext highlighter-rouge">fork { exec("...") }</code></p>

<h2 id="adding-sound-effects-to-your-test-suite">Adding sound effects to your test suite</h2>

<p>Now for the RSpec hack. Within your <code class="language-plaintext highlighter-rouge">RSpec.configure do |config|</code> block, we’ll need to add an <code class="language-plaintext highlighter-rouge">after(:suite)</code> hook. Next we dig into the RSpec::Core::Reporter to count the number of failed examples. Finally we can put it all together in our RSpec configuration.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">config</span><span class="p">.</span><span class="nf">after</span><span class="p">(</span><span class="ss">:suite</span><span class="p">)</span> <span class="k">do</span>
    <span class="k">if</span> <span class="n">config</span><span class="p">.</span><span class="nf">reporter</span><span class="p">.</span><span class="nf">failed_examples</span><span class="p">.</span><span class="nf">size</span> <span class="o">==</span> <span class="mi">0</span>
      <span class="nb">fork</span> <span class="p">{</span> <span class="nb">exec</span><span class="p">(</span><span class="s2">"afplay ~/Music/okurrrt.mp3"</span><span class="p">)</span> <span class="p">}</span>
    <span class="k">else</span>
      <span class="nb">fork</span> <span class="p">{</span> <span class="nb">exec</span><span class="p">(</span><span class="s2">"afplay ~/Music/eowwww.mp3"</span><span class="p">)</span> <span class="p">}</span>
    <span class="k">end</span>
  <span class="k">end</span>
</code></pre></div></div>

<p>If you want to get even fancier you can add some variety and randomness to the sound effect played. We can add randomization by using Ruby’s <strong>array#sample</strong>. For variety, I’ll add clips of #SELFIE from
The Chainsmokers and DJ Khaled <em>another one</em> to the list. Why not?</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">config</span><span class="p">.</span><span class="nf">after</span><span class="p">(</span><span class="ss">:suite</span><span class="p">)</span> <span class="k">do</span>
    <span class="k">if</span> <span class="n">config</span><span class="p">.</span><span class="nf">reporter</span><span class="p">.</span><span class="nf">failed_examples</span><span class="p">.</span><span class="nf">size</span> <span class="o">==</span> <span class="mi">0</span>
      <span class="n">success</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">"~/Music/okurrrt.mp3"</span><span class="p">,</span>
        <span class="s2">"~/Music/selfie.mp3"</span><span class="p">,</span>
        <span class="s2">"~/Music/another_one.mp3"</span>
      <span class="p">]</span>
      <span class="nb">fork</span> <span class="p">{</span> <span class="nb">exec</span><span class="p">(</span><span class="s2">"afplay </span><span class="si">#{</span><span class="n">success</span><span class="p">.</span><span class="nf">sample</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span> <span class="p">}</span>
    <span class="k">else</span>
      <span class="nb">fork</span> <span class="p">{</span> <span class="nb">exec</span><span class="p">(</span><span class="s2">"afplay ~/Music/eowwww.mp3"</span><span class="p">)</span> <span class="p">}</span>
    <span class="k">end</span>
  <span class="k">end</span>
</code></pre></div></div>

<p><img src="/img/2021/okurrrt.gif" alt="Cardi B okurrrt" /></p>

<p>With the above, I can <em>okurrrt</em> and <em>#selfie</em> my way to a green testing suite. Want to hear some more of Cardi B? <a href="https://youtu.be/YplKPH_qcRw?t=154" target="_blank">Check out this YouTube video.</a></p>


  <!-- Prev Posts -->
  <div class="Post-actions">
    
      <a class="Post-actions--prev TooltipContainer" href="/blog/ordinal-abbreviations-for-dates-in-rails/" alt="Ordinal abbreviations for dates in Rails">&#171; Previous Post<div class="TooltipContainer-text TooltipContainer-text--post">Ordinal abbreviations for dates in Rails</div></a>
    
    
      <a class="Post-actions--next TooltipContainer" href="/blog/using-hotwire-to-build-a-search-form/" alt="Using Hotwire to build a search form with minimal JavaScript">Next Post &#187;<div class="TooltipContainer-text TooltipContainer-text--post">Using Hotwire to build a search form with minimal JavaScript</div></a>
    
  </div>

  <!-- Comments System -->
  <div class="Comments">
    <h2>Join the conversation</h2>

    <div id="disqus_thread"></div>
  </div>

  <script type="text/javascript">
      var disqus_shortname = 'joshmfrankel';
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</article>

    </div>

    <footer class="Footer">
  <div class="Container Container-flex Container--smallMargin">
    <section class="Footer-links">
      
        
        <a href="/blog" >Blog</a>
      
        
        <a href="/blog/categories" >Categories</a>
      
        
        <a href="/blog/tags" >Tags</a>
      
        
        <a href="/blog/archives" >Archives</a>
      
        
        <a href="/" >About</a>
      
    </section>
  </div>

  <div class="Footer-actions">
    <div class="Container Container--smallMargin">
      <div class="FooterActions">
        <section class="FooterActions-posts">
          <h2 class="FooterActions-title">Latest Posts</h2>
          <nav>
            
              <a href="/blog/when-is-an-array-an-array-strategies-for-checking-array-equality-in-ruby/">When is an Array an Array? Strategies for checking Array equality in Ruby</a>
            
              <a href="/blog/how-to-fix-homebrew-postgres-error-256/">How to fix homebrew postgres error 256</a>
            
              <a href="/blog/dont-slack-on-site-reliability/">Don't Slack on Site Reliability</a>
            
              <a href="/blog/creating-blurred-background-images-with-overlay-text-in-css/">Creating blurred background images with overlay text in CSS</a>
            
              <a href="/blog/lemme-pencil-you-in-using-icalendar-and-rails-to-sync-calendar-events/">Lemme pencil you in: Using iCalendar and Rails to sync calendar events</a>
            
              <a href="/blog/introducing-simplecov+-action-a-github-action-for-ensuring-test-coverage/">Introducing SimpleCov+ Action: A Github action for ensuring test coverage</a>
            
          </nav>
        </section>

        <section class="FooterActions-contact">
          <h2 class="FooterActions-title">Get in Contact with Me</h2>
          <nav>
            <a href="mailto:joshmfrankel+website@gmail.com">
              <i class="fa fa-paper-plane" aria-hidden="true"></i>&nbsp;
              I'm easy to get a hold of
            </a>

            <a href="https://github.com/joshmfrankel">
              <i class="fab fa-github-alt" aria-hidden="true"></i>&nbsp;
              I have no (git) commit hangups
            </a>

            <a href="https://rubyonrails-link.slack.com/messages/@joshmfrankel/">
              <i class="fab fa-slack-hash" aria-hidden="true"></i>&nbsp;
              I share what I learn
            </a>

            <a href="https://stackoverflow.com/users/906974/josh-frankel">
              <i class="fab fa-stack-overflow" aria-hidden="true"></i>&nbsp;
              I give back to the community
            </a>

            <a href="https://twitter.com/Joshmfrankel">
              <i class="fab fa-twitter" aria-hidden="true"></i>&nbsp;
              I like to be social
            </a>

            <a href="https://www.linkedin.com/in/joshmfrankel/">
              <i class="fab fa-linkedin" aria-hidden="true"></i>&nbsp;
              I take professionalism seriously
            </a>
          </nav>
        </section>
      </div>

      <section class="Footer-actions-copyright">
        <p>© 2011-2023+ Josh Frankel. Development Simplified. All rights reserved</p>
      </section>
    </div>
  </div>
</footer>




    
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-40607351-1', 'auto');
    ga('send', 'pageview');
  </script>


  </body>
</html>
